<!DOCTYPE html>
<html lang="pt-PT">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia de Observa√ß√£o Biol√≥gica: O Alfaiate</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Lato:wght@300;400;700&display=swap"
        rel="stylesheet">
    <style>
        :root {
            --brand-purple: #6b21a8;
            --brand-gold: #d97706;
            --paper-cream: #fdfbf7;
        }

        body {
            font-family: 'Lato', sans-serif;
            background-color: var(--paper-cream);
            color: #1f2937;
        }

        h1,
        h2,
        h3,
        .classic-font {
            font-family: 'Cinzel', serif;
        }

        /* Glassmorphism Header */
        .glass-nav {
            background: rgba(107, 33, 168, 0.85);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Flip Card Effects */
        .perspective-1000 {
            perspective: 1000px;
        }

        .transform-style-3d {
            transform-style: preserve-3d;
        }

        .backface-hidden {
            backface-visibility: hidden;
        }

        .rotate-y-180 {
            transform: rotateY(180deg);
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        ::-webkit-scrollbar-thumb {
            background: #c084fc;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #a855f7;
        }

        /* Print Styles for Certificate */
        @media print {
            body * {
                visibility: hidden;
            }

            #certificate-area,
            #certificate-area * {
                visibility: visible;
            }

            #certificate-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }

            .no-print {
                display: none !important;
            }
        }

        /* Animation Utilities */
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="min-h-screen flex flex-col">

    <!-- Navigation -->
    <header class="glass-nav fixed top-0 w-full z-50 transition-all duration-300 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center gap-2">
                    <span class="text-2xl text-white classic-font font-bold tracking-widest">O ALFAIATE</span>
                    <span
                        class="text-purple-200 text-xs hidden sm:inline-block border border-purple-300 rounded px-2 py-0.5">Recurvirostra
                        avosetta</span>
                </div>
                <!-- Desktop Nav -->
                <nav class="hidden md:flex items-center space-x-4">
                    <button onclick="switchTab('study')"
                        class="nav-btn text-purple-100 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors"
                        data-tab="study">Guia de Estudo</button>
                    <button onclick="switchTab('flashcards')"
                        class="nav-btn text-purple-100 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors"
                        data-tab="flashcards">Flashcards</button>
                    <button onclick="switchTab('glossary')"
                        class="nav-btn text-purple-100 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors"
                        data-tab="glossary">Gloss√°rio</button>
                    <button onclick="switchTab('quiz')"
                        class="nav-btn text-purple-100 hover:text-white px-3 py-2 rounded-md text-sm font-medium transition-colors"
                        data-tab="quiz">Aprendizagem Ativa</button>
                    <!-- User Guide Button -->
                    <button onclick="openModal('user-guide-modal')"
                        class="ml-4 p-2 bg-yellow-500 hover:bg-yellow-400 text-purple-900 rounded-full shadow-md transition-transform hover:scale-110 flex items-center justify-center"
                        title="Guia de Utilizador">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                                d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </button>
                </nav>
                <!-- Mobile Menu Button -->
                <div class="md:hidden flex items-center gap-3">
                    <button onclick="openModal('user-guide-modal')"
                        class="p-1.5 bg-yellow-500 text-purple-900 rounded-full">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
                                d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </button>
                    <button onclick="toggleMobileMenu()" class="text-white hover:text-purple-200 focus:outline-none">
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden bg-purple-900 border-t border-purple-700">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <button onclick="switchTab('study')"
                    class="block text-gray-300 hover:text-white px-3 py-2 rounded-md text-base font-medium w-full text-left">Guia
                    de Estudo</button>
                <button onclick="switchTab('flashcards')"
                    class="block text-gray-300 hover:text-white px-3 py-2 rounded-md text-base font-medium w-full text-left">Flashcards</button>
                <button onclick="switchTab('glossary')"
                    class="block text-gray-300 hover:text-white px-3 py-2 rounded-md text-base font-medium w-full text-left">Gloss√°rio</button>
                <button onclick="switchTab('quiz')"
                    class="block text-gray-300 hover:text-white px-3 py-2 rounded-md text-base font-medium w-full text-left">Quiz</button>
            </div>
        </div>
        <!-- Progress Bar -->
        <div class="w-full bg-purple-900 h-1">
            <div id="progress-bar" class="bg-yellow-400 h-1 transition-all duration-500" style="width: 0%"></div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="flex-grow pt-20 pb-10 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto w-full">

        <!-- SEC√á√ÉO I: GUIA DE ESTUDO -->
        <section id="study" class="tab-content fade-in">
            <div class="text-center mb-10">
                <h2 class="text-4xl text-purple-900 mb-2 classic-font">Guia de Estudo</h2>
                <p class="text-gray-600 italic">Uma viagem pela biologia e ecologia da "Ave S√≠mbolo" do Estu√°rio do
                    Tejo.</p>
            </div>

            <!-- Multimedia Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-12">
                <!-- Video -->
                <div class="bg-white p-3 shadow-lg rounded-lg border border-gray-200 flex flex-col">
                    <h3 class="text-lg font-bold text-purple-800 mb-3 border-b border-gray-100 pb-2">Videoteca: Asa, o
                        Pequeno Alfaiate</h3>
                    <!-- Aspect Ratio Wrapper 4:3 (75% padding for 640x480) -->
                    <div class="relative w-full overflow-hidden rounded-md shadow-inner bg-black"
                        style="padding-top: 75%;">
                        <iframe class="absolute top-0 left-0 w-full h-full"
                            src="https://drive.google.com/file/d/1G46ZYP-CplFgR0qibkPXDoeIXCbFLjhC/preview" width="640"
                            height="480" frameborder="0" allow="autoplay" allowfullscreen>
                        </iframe>
                    </div>
                    <!-- Fallback link for playback errors -->
                    <div class="p-2 text-center bg-gray-50 mt-3 rounded">
                        <a href="https://drive.google.com/file/d/1G46ZYP-CplFgR0qibkPXDoeIXCbFLjhC/view" target="_blank"
                            class="inline-flex items-center text-xs font-bold text-purple-700 hover:text-purple-900 transition-colors">
                            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 24 24">
                                <path
                                    d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z" />
                            </svg>
                            Ver no Google Drive (Caso o v√≠deo n√£o inicie)
                        </a>
                    </div>
                </div>

                <!-- Multimedia Resources -->
                <div class="flex flex-col gap-6">
                    <!-- Infografia -->
                    <div class="bg-white p-4 shadow-md rounded-lg border-l-4 border-purple-500">
                        <div class="mb-3">
                            <h3 class="font-bold text-purple-800 flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z">
                                    </path>
                                </svg>
                                Infografia Interativa
                            </h3>
                            <p class="text-sm text-gray-600 mt-1">Explore os detalhes anat√≥micos e o ciclo de vida.
                                <strong>Clique na imagem para ampliar.</strong>
                            </p>
                        </div>

                        <!-- Visible Image Preview -->
                        <div class="relative group cursor-zoom-in rounded-lg overflow-hidden border border-gray-200 shadow-sm"
                            onclick="openModal('infographic-modal')">
                            <img src="./infografia.jpg"
                                alt="Infografia cient√≠fica do Alfaiate: Anatomia, Habitat e Ciclo de Vida"
                                class="w-full h-auto object-cover transition-transform duration-500 group-hover:scale-105"
                                onerror="this.onerror=null; this.parentElement.innerHTML='<div class=\'h-48 bg-gray-100 flex flex-col items-center justify-center text-gray-500 text-sm p-4 text-center\'><span class=\'text-2xl mb-2\'>üñºÔ∏è</span>Imagem (./infografia.jpg) n√£o encontrada.<br>Adicione o ficheiro √† pasta.</div>';">

                            <!-- Overlay Hint -->
                            <div
                                class="absolute inset-0 bg-purple-900 bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center">
                                <span
                                    class="bg-white text-purple-900 px-4 py-2 rounded-full font-bold text-sm shadow-lg transform translate-y-4 opacity-0 group-hover:opacity-100 group-hover:translate-y-0 transition-all duration-300">
                                    üîç Ver em Ecr√£ Inteiro
                                </span>
                            </div>
                        </div>
                    </div>

                    <!-- Podcast -->
                    <div class="bg-white p-4 shadow-md rounded-lg border-l-4 border-yellow-500">
                        <h3 class="font-bold text-purple-800 flex items-center gap-2 mb-2">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z">
                                </path>
                            </svg>
                            Podcast Educativo
                        </h3>
                        <p class="text-sm text-gray-600 mb-3">Ou√ßa a narrativa sobre a migra√ß√£o e conserva√ß√£o.</p>
                        <audio controls class="w-full h-10 rounded bg-gray-100">
                            <source src="./podcast.mp3" type="audio/mpeg">
                            O seu navegador n√£o suporta o elemento de √°udio.
                        </audio>
                    </div>
                </div>
            </div>

            <!-- Content Accordions -->
            <div id="study-content" class="space-y-4 max-w-4xl mx-auto">
                <!-- Content will be injected by JS -->
            </div>
        </section>

        <!-- SEC√á√ÉO II: FLASHCARDS -->
        <section id="flashcards" class="tab-content hidden fade-in">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h2 class="text-3xl text-purple-900 classic-font">Cart√µes de Estudo</h2>
                    <p class="text-gray-600">Memorize conceitos-chave sobre o Alfaiate.</p>
                </div>
                <div class="flex space-x-2">
                    <button onclick="setFlashcardMode('view')"
                        class="px-4 py-2 bg-purple-600 text-white rounded shadow hover:bg-purple-700 text-sm">Modo
                        Estudo</button>
                    <button onclick="setFlashcardMode('game')"
                        class="px-4 py-2 bg-yellow-500 text-white rounded shadow hover:bg-yellow-600 text-sm">Jogo de
                        Correspond√™ncia</button>
                </div>
            </div>

            <!-- Flashcard Viewer Mode -->
            <div id="fc-view-mode" class="flex flex-col items-center">
                <div class="perspective-1000 w-full max-w-lg h-80 cursor-pointer group" onclick="flipCard(this)">
                    <div id="current-flashcard"
                        class="relative w-full h-full transition-transform duration-700 transform-style-3d shadow-xl rounded-xl">
                        <!-- Front -->
                        <div
                            class="absolute w-full h-full bg-white border-2 border-purple-200 rounded-xl flex flex-col items-center justify-center p-8 backface-hidden">
                            <span
                                class="text-purple-500 text-sm font-bold tracking-widest uppercase mb-4">Pergunta</span>
                            <p id="fc-front" class="text-xl md:text-2xl text-center text-gray-800 font-medium">--</p>
                            <p class="absolute bottom-4 text-xs text-gray-400">Toque para virar</p>
                        </div>
                        <!-- Back -->
                        <div
                            class="absolute w-full h-full bg-purple-600 rounded-xl flex flex-col items-center justify-center p-8 backface-hidden rotate-y-180">
                            <span
                                class="text-purple-200 text-sm font-bold tracking-widest uppercase mb-4">Resposta</span>
                            <p id="fc-back" class="text-xl md:text-2xl text-center text-white font-medium">--</p>
                        </div>
                    </div>
                </div>

                <div class="flex items-center space-x-8 mt-8">
                    <button onclick="prevCard()"
                        class="p-3 rounded-full bg-white shadow-md hover:bg-gray-100 text-purple-700">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7">
                            </path>
                        </svg>
                    </button>
                    <span id="fc-counter" class="font-mono text-gray-500">1 / 30</span>
                    <button onclick="nextCard()"
                        class="p-3 rounded-full bg-white shadow-md hover:bg-gray-100 text-purple-700">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7">
                            </path>
                        </svg>
                    </button>
                </div>
            </div>

            <!-- Flashcard Game Mode -->
            <div id="fc-game-mode" class="hidden">
                <p class="text-center mb-4 text-gray-600">Arraste a defini√ß√£o (Direita) para o termo correto (Esquerda)
                    ou clique em ambos para emparelhar.</p>
                <div id="fc-game-container" class="grid grid-cols-1 md:grid-cols-2 gap-4 max-w-5xl mx-auto">
                    <!-- Game content generated by JS -->
                </div>
                <div id="fc-game-message" class="text-center mt-6 text-xl font-bold text-purple-700 min-h-[2rem]"></div>
                <div class="text-center mt-4">
                    <button onclick="initMatchGame('flashcards')"
                        class="text-sm underline text-gray-500 hover:text-purple-700">Reiniciar Jogo</button>
                </div>
            </div>
        </section>

        <!-- SEC√á√ÉO III: GLOSS√ÅRIO -->
        <section id="glossary" class="tab-content hidden fade-in">
            <div class="flex justify-between items-center mb-8">
                <div>
                    <h2 class="text-3xl text-purple-900 classic-font">Gloss√°rio T√©cnico</h2>
                    <p class="text-gray-600">Terminologia essencial da biologia e conserva√ß√£o.</p>
                </div>
                <div class="flex space-x-2">
                    <button onclick="setGlossaryMode('list')"
                        class="px-4 py-2 bg-purple-600 text-white rounded shadow hover:bg-purple-700 text-sm">Lista</button>
                    <button onclick="setGlossaryMode('game')"
                        class="px-4 py-2 bg-yellow-500 text-white rounded shadow hover:bg-yellow-600 text-sm">Jogo</button>
                </div>
            </div>

            <!-- List Mode -->
            <div id="glossary-list-mode" class="grid grid-cols-1 md:grid-cols-2 gap-6 max-w-6xl mx-auto">
                <!-- Content Injected via JS -->
            </div>

            <!-- Game Mode -->
            <div id="glossary-game-mode" class="hidden">
                <p class="text-center mb-4 text-gray-600">Selecione um termo e a sua defini√ß√£o correspondente.</p>
                <div id="glossary-game-container" class="flex flex-wrap gap-4 justify-center">
                    <!-- Cards injected by JS -->
                </div>
                <div id="glossary-game-message" class="text-center mt-6 text-xl font-bold text-purple-700 min-h-[2rem]">
                </div>
                <div class="text-center mt-4">
                    <button onclick="initMatchGame('glossary')"
                        class="text-sm underline text-gray-500 hover:text-purple-700">Reiniciar Jogo</button>
                </div>
            </div>
        </section>

        <!-- SEC√á√ÉO IV: APRENDIZAGEM ATIVA (QUIZ) -->
        <section id="quiz" class="tab-content hidden fade-in">
            <div class="max-w-3xl mx-auto">
                <div class="text-center mb-10">
                    <h2 class="text-3xl text-purple-900 classic-font">Question√°rio de Avalia√ß√£o</h2>
                    <p class="text-gray-600 mb-4">Teste os seus conhecimentos para obter o certificado de Jovem Bi√≥logo.
                    </p>

                    <!-- Medals Display -->
                    <div class="flex justify-center gap-4 mb-6">
                        <div id="medal-bronze" class="opacity-30 flex flex-col items-center">
                            <span class="text-3xl">ü•â</span>
                            <span class="text-xs font-bold text-yellow-800">Bronze</span>
                        </div>
                        <div id="medal-silver" class="opacity-30 flex flex-col items-center">
                            <span class="text-3xl">ü•à</span>
                            <span class="text-xs font-bold text-gray-500">Prata</span>
                        </div>
                        <div id="medal-gold" class="opacity-30 flex flex-col items-center">
                            <span class="text-3xl">ü•á</span>
                            <span class="text-xs font-bold text-yellow-500">Ouro</span>
                        </div>
                    </div>
                </div>

                <!-- Start Screen -->
                <div id="quiz-start" class="bg-white p-8 rounded-xl shadow-lg border-t-4 border-purple-600 text-center">
                    <p class="mb-6 text-lg">Este question√°rio cont√©m perguntas de Escolha M√∫ltipla e Verdadeiro/Falso.
                        Ter√° feedback imediato para cada resposta.</p>
                    <button onclick="startQuiz()"
                        class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-8 rounded-full text-lg shadow-md transition transform hover:scale-105">
                        Iniciar Desafio
                    </button>
                    <p class="mt-4 text-sm text-gray-400">Pontua√ß√£o m√°xima guardada: <span id="high-score">0</span></p>
                </div>

                <!-- Question Container -->
                <div id="quiz-container" class="hidden">
                    <div class="mb-4 flex justify-between items-center">
                        <span class="text-sm font-bold text-purple-600">Quest√£o <span id="q-current">1</span>/<span
                                id="q-total">33</span></span>
                        <span class="text-sm font-bold text-gray-600">Pontos: <span id="current-score">0</span></span>
                    </div>

                    <div class="bg-white p-6 md:p-8 rounded-xl shadow-md border border-gray-200">
                        <h3 id="question-text" class="text-xl font-bold text-gray-800 mb-6">--</h3>
                        <div id="options-container" class="space-y-3">
                            <!-- Options injected here -->
                        </div>
                    </div>

                    <!-- Feedback Area -->
                    <div id="feedback-area" class="mt-6 hidden p-4 rounded-lg bg-blue-50 border border-blue-200">
                        <h4 id="feedback-title" class="font-bold mb-1">Feedback</h4>
                        <p id="feedback-text" class="text-sm text-blue-800"></p>
                        <button onclick="nextQuestion()"
                            class="mt-4 bg-blue-600 text-white px-6 py-2 rounded shadow hover:bg-blue-700">Pr√≥xima</button>
                    </div>
                </div>

                <!-- Results / Certificate Generation -->
                <div id="quiz-results" class="hidden bg-white p-8 rounded-xl shadow-lg text-center">
                    <h3 class="text-2xl font-bold text-purple-900 mb-4">Quiz Terminado!</h3>
                    <p class="text-lg mb-2">A sua pontua√ß√£o final: <span id="final-score"
                            class="font-bold text-purple-600 text-3xl">0</span></p>
                    <p id="result-message" class="mb-6 text-gray-600 italic">--</p>

                    <div class="border-t pt-6">
                        <label class="block text-left text-sm font-bold text-gray-700 mb-2">Nome para o
                            Certificado:</label>
                        <input type="text" id="student-name"
                            class="w-full p-3 border rounded mb-4 focus:ring-2 focus:ring-purple-500 outline-none"
                            placeholder="Escreve o teu nome aqui...">
                        <div class="flex gap-4 justify-center">
                            <button onclick="generateCertificate()"
                                class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-6 rounded shadow-md">
                                üìú Obter Certificado
                            </button>
                            <button onclick="resetQuiz()"
                                class="bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 px-6 rounded">
                                Tentar Novamente
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-white border-t border-gray-200 mt-auto py-6 no-print">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="text-gray-800 font-bold text-sm tracking-wide">Teod√≥sio Faria ¬©2026 Guia Educativo sobre o
                Alfaiate</p>
            <p class="text-xs text-gray-400 mt-1 italic">Uma viagem pela biologia e ecologia da "Ave S√≠mbolo" do
                Estu√°rio do Tejo</p>
        </div>
    </footer>

    <!-- MODALS -->

    <!-- User Guide Modal -->
    <div id="user-guide-modal"
        class="fixed inset-0 bg-black bg-opacity-70 z-[60] hidden flex items-center justify-center p-4"
        onclick="if(event.target === this) closeModal('user-guide-modal')">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full overflow-hidden flex flex-col max-h-[90vh]">
            <div class="bg-purple-800 p-6 text-white flex justify-between items-center">
                <h3 class="text-2xl classic-font tracking-widest font-bold">Guia de Utilizador</h3>
                <button onclick="closeModal('user-guide-modal')"
                    class="text-white hover:text-purple-200 transition-colors text-3xl font-light">‚úï</button>
            </div>
            <div class="p-8 overflow-y-auto space-y-6">
                <section>
                    <h4 class="font-bold text-purple-800 border-b border-purple-100 pb-2 mb-3 flex items-center gap-2">
                        <span class="text-xl">üöÄ</span> Como Navegar
                    </h4>
                    <p class="text-gray-600 text-sm leading-relaxed">Utilize a barra superior para navegar entre as 4
                        sec√ß√µes principais. A barra de progresso no topo indica a sua jornada atrav√©s dos conte√∫dos.</p>
                </section>

                <section>
                    <h4 class="font-bold text-purple-800 border-b border-purple-100 pb-2 mb-3 flex items-center gap-2">
                        <span class="text-xl">üìö</span> Sec√ß√µes Pedag√≥gicas
                    </h4>
                    <ul class="space-y-4 text-sm">
                        <li class="flex gap-3">
                            <span class="bg-purple-100 text-purple-700 p-2 rounded-lg h-fit">01</span>
                            <div>
                                <strong class="text-gray-800">Guia de Estudo:</strong> Assista ao v√≠deo document√°rio,
                                ou√ßa o podcast narrativo e explore as infografias e textos t√©cnicos em acorde√£o.
                            </div>
                        </li>
                        <li class="flex gap-3">
                            <span class="bg-purple-100 text-purple-700 p-2 rounded-lg h-fit">02</span>
                            <div>
                                <strong class="text-gray-800">Flashcards:</strong> Memoriza√ß√£o ativa. No modo estudo,
                                clique no cart√£o para revelar a resposta. No modo jogo, arraste e emparelhe os termos.
                            </div>
                        </li>
                        <li class="flex gap-3">
                            <span class="bg-purple-100 text-purple-700 p-2 rounded-lg h-fit">03</span>
                            <div>
                                <strong class="text-gray-800">Gloss√°rio:</strong> Consulte a terminologia cient√≠fica.
                                Utilize o modo jogo para testar a sua compreens√£o das defini√ß√µes.
                            </div>
                        </li>
                        <li class="flex gap-3">
                            <span class="bg-purple-100 text-purple-700 p-2 rounded-lg h-fit">04</span>
                            <div>
                                <strong class="text-gray-800">Quiz:</strong> O desafio final. Responda √†s 15 perguntas
                                para ganhar as medalhas de bronze, prata ou ouro.
                            </div>
                        </li>
                    </ul>
                </section>

                <section>
                    <h4 class="font-bold text-purple-800 border-b border-purple-100 pb-2 mb-3 flex items-center gap-2">
                        <span class="text-xl">üìú</span> Certifica√ß√£o
                    </h4>
                    <p class="text-gray-600 text-sm leading-relaxed">Ao terminar o Quiz, poder√° inserir o seu nome para
                        gerar um <strong>Certificado de M√©rito</strong> oficial, que pode ser impresso ou guardado como
                        PDF.</p>
                </section>

                <div class="bg-purple-50 p-4 rounded-xl text-center">
                    <p class="text-purple-900 font-bold text-sm">Bons estudos, Jovem Bi√≥logo!</p>
                </div>
            </div>
            <div class="p-4 bg-gray-50 border-t flex justify-end">
                <button onclick="closeModal('user-guide-modal')"
                    class="bg-purple-800 text-white px-6 py-2 rounded-full hover:bg-purple-900 transition-colors font-bold text-sm">Entendido!</button>
            </div>
        </div>
    </div>

    <!-- Infographic Modal -->
    <div id="infographic-modal"
        class="fixed inset-0 bg-black bg-opacity-90 z-50 hidden flex items-center justify-center p-4"
        onclick="if(event.target === this) closeModal('infographic-modal')">
        <div class="relative w-full h-full flex flex-col">
            <button onclick="closeModal('infographic-modal')"
                class="absolute top-4 right-4 text-white hover:text-gray-300 text-3xl font-bold z-50">‚úï</button>
            <div class="w-full h-full flex items-center justify-center">
                <!-- Image fitted to screen -->
                <img src="./infografia.jpg" alt="Infografia do Alfaiate"
                    class="max-w-full max-h-full object-contain shadow-2xl"
                    onerror="this.onerror=null; this.src='https://picsum.photos/1200/800?grayscale'; alert('Certifique-se que o ficheiro infografia.jpg existe na pasta raiz.');">
            </div>
        </div>
    </div>

    <!-- Certificate Template (Hidden until Print) -->
    <div id="certificate-area"
        class="hidden bg-white p-10 text-center border-[20px] border-double border-purple-900 h-screen flex flex-col justify-center items-center bg-[url('https://www.transparenttextures.com/patterns/cream-paper.png')]">
        <h1 class="text-5xl classic-font text-purple-900 mb-8 tracking-widest uppercase">Certificado de M√©rito</h1>
        <p class="text-xl text-gray-600 mb-4">Certifica-se que</p>
        <h2 id="cert-name"
            class="text-4xl font-bold text-black border-b-2 border-black pb-2 mb-8 px-10 italic font-serif">Nome do
            Aluno</h2>
        <p class="text-lg text-gray-700 max-w-2xl mx-auto mb-8">
            Concluiu com sucesso o percurso de aprendizagem sobre o <strong>Alfaiate (Recurvirostra avosetta)</strong>,
            demonstrando conhecimentos sobre a sua biologia, habitat e conserva√ß√£o.
        </p>
        <div class="flex justify-between w-full max-w-2xl mt-10">
            <div class="text-center">
                <div
                    class="w-32 h-32 rounded-full border-4 border-yellow-500 flex items-center justify-center mb-2 mx-auto">
                    <span class="text-4xl">üèÖ</span>
                </div>
                <p class="font-bold text-yellow-600 uppercase tracking-wider">Aprova√ß√£o</p>
            </div>
            <div class="text-right pt-16">
                <div class="border-t border-gray-400 w-48 ml-auto"></div>
                <p class="text-sm text-gray-500 mt-1">Data: <span id="cert-date"></span></p>
            </div>
        </div>
    </div>

    <script>
        // --- DATA OBJECTS --- //

        const studyData = [
            {
                id: "identificacao",
                title: "Perfil de Identifica√ß√£o e Taxonomia",
                icon: "üëÅÔ∏è",
                content: `
            <div class="space-y-3">
                <p class="font-bold text-purple-800 border-b border-purple-200 pb-1">Classifica√ß√£o Taxon√≥mica</p>
                <ul class="list-disc pl-5 space-y-1 text-gray-700 text-sm">
                    <li><strong>Ordem:</strong> Charadriiformes (Lim√≠colas)</li>
                    <li><strong>Fam√≠lia:</strong> Recurvirostridae</li>
                    <li><strong>Nome Cient√≠fico:</strong> <em>Recurvirostra avosetta</em></li>
                    <li><strong>Nome Comum:</strong> Alfaiate</li>
                </ul>
                
                <p class="font-bold text-purple-800 border-b border-purple-200 pb-1 mt-4">Morfologia Distintiva</p>
                <ul class="list-disc pl-5 space-y-2 text-gray-700">
                    <li><strong>Apar√™ncia Geral:</strong> "Silhueta de costureira" inconfund√≠vel. Plumagem predominantemente branca com manchas pretas n√≠tidas na coroa (topo da cabe√ßa), nuca e faixas nas asas e dorso. Contraste gr√°fico impec√°vel entre branco puro e preto estrategicamente distribu√≠do.</li>
                    <li><strong>Dimens√µes:</strong> Porte m√©dio-grande para uma lim√≠cola, atingindo 42 a 46 cm de comprimento. Ave elegante e sofisticada.</li>
                    <li><strong>O Bico Extraordin√°rio:</strong> Longo, fino, preto e distintamente <strong>recurvado para cima</strong> na extremidade. Longe de ser uma estrutura r√≠gida como osso, este bico √© <strong>sens√≠vel e flex√≠vel como borracha</strong>, funcionando quase como um √≥rg√£o t√°til. Esta √© a sua caracter√≠stica mais fascinante e funcional.</li>
                    <li><strong>Patas:</strong> Longas e cinzento-azuladas, permitindo caminhar em √°guas mais profundas que outras lim√≠colas. <strong>P√©s palmados</strong> (raro em lim√≠colas), facilitando a nata√ß√£o - ao contr√°rio de muitas lim√≠colas que apenas caminham, o Alfaiate nada muito bem gra√ßas √†s membranas interdigitais.</li>
                    <li><strong>Longevidade:</strong> Pode atingir aproximadamente 28 anos de idade, demonstrando grande resili√™ncia.</li>
                    <li><strong>Dimorfismo Sexual:</strong> Pouco evidente. A f√™mea pode ter o anel branco na base do bico ligeiramente mais largo e o bico por vezes mais curto e curvo, mas a distin√ß√£o em campo √© dif√≠cil.</li>
                </ul>

                <div class="bg-blue-50 p-3 rounded mt-3 border-l-4 border-blue-400">
                    <p class="text-sm"><strong>Identifica√ß√£o no Campo:</strong> O efeito de "brilho" ou cintila√ß√£o do bando em voo √© caracter√≠stico. Como a parte inferior das asas √© branca, o bando parece cintilar e mudar de cor em un√≠ssono √† medida que as aves inclinam o corpo durante as manobras a√©reas.</p>
                </div>
            </div>
        `
            },
            {
                id: "alimentacao",
                title: "Alimenta√ß√£o e T√©cnica de Varrimento",
                icon: "ü¶ê",
                content: `
            <div class="space-y-3">
                <p class="mb-2 text-gray-800">O bico do Alfaiate √© uma ferramenta evolutiva extraordin√°ria: longo, fino, preto e distintamente <strong>recurvado para cima</strong> na extremidade. Esta anatomia singular n√£o √© um mero capricho est√©tico da evolu√ß√£o; o bico √© uma ferramenta de precis√£o que dita a forma como esta ave interage com o ecossistema estuarino.</p>
                
                <div class="bg-gray-50 p-3 rounded border-l-4 border-blue-400">
                    <h4 class="font-bold text-blue-800 mb-1">A T√©cnica do "Coser" - Varrimento (Scything/Sweeping)</h4>
                    <p class="text-sm">O nome "Alfaiate" deriva do movimento r√≠tmico e lateral que a ave executa com o bico, assemelhando-se ao gesto minucioso de um mestre de costura a passar a agulha pelo tecido. A ave caminha em √°guas pouco profundas e move a cabe√ßa lateralmente em arcos de 40 a 60 graus, mantendo a ponta do bico ligeiramente aberta submersa no lodo superficial. Ao contr√°rio de outros ma√ßaricos que perfuram o solo em profundidade, o Alfaiate deteta as suas presas pelo toque imediato.</p>
                </div>

                <ul class="list-disc pl-5 space-y-2 text-gray-700 mt-2">
                    <li><strong>Mecanismo T√°til:</strong> O bico funciona como √≥rg√£o t√°til, detetando presas ao toque e n√£o pela vis√£o. Com uma sensibilidade compar√°vel √† borracha, permite a alimenta√ß√£o em √°guas turvas ou durante a noite.</li>
                    <li><strong>Alimenta√ß√£o Noturna:</strong> Devido √† extrema sensibilidade do bico, o Alfaiate <strong>n√£o depende da luz solar</strong> para ca√ßar. Consegue alimentar-se com total sucesso durante a noite, independentemente do ciclo lunar ou das mar√©s, enquanto as aves que ca√ßam pela vis√£o descansam.</li>
                    <li><strong>Ritmo de Atividade:</strong> 
                        <ul class="list-circle pl-5 mt-1">
                            <li>Ritmo Normal: <strong>28 varrivelas por minuto</strong></li>
                            <li>Ritmo Acelerado: At√© <strong>46 varrivelas por minuto</strong> em per√≠odos de maior exig√™ncia energ√©tica</li>
                        </ul>
                    </li>
                    <li><strong>Requisito de Substrato Cr√≠tico:</strong> A alimenta√ß√£o t√°til exige <strong>sedimentos brandos</strong> e, crucialmente, <strong>isentos de rochas ou fragmentos de conchas</strong>, que podem danificar as estruturas sensoriais do bico.</li>
                    <li><strong>Dieta:</strong> Estritamente carn√≠vora. Alimenta-se de pequenos invertebrados aqu√°ticos: larvas de insetos aqu√°ticos, anel√≠deos (vermes poliquetas), pequenos crust√°ceos.</li>
                    <li><strong>Artemia nas Salinas:</strong> Nas salinas, consome em grande quantidade a <em>Artemia salina</em>, um pequeno crust√°ceo abundante nestes habitats hipersalinos.</li>
                </ul>

                <div class="bg-yellow-50 p-3 rounded mt-3 border-l-4 border-yellow-500">
                    <p class="text-sm font-bold text-yellow-800">Indicador Ambiental</p>
                    <p class="text-xs text-yellow-700">Esta especializa√ß√£o torna a esp√©cie um <strong>indicador precoce de polui√ß√£o sedimentar</strong>. Dado que o Alfaiate "varre" a camada superficial do lodo, √© a primeira esp√©cie a ingerir contaminantes que precipitam nos estu√°rios, como o merc√∫rio no Tejo. A monitoriza√ß√£o da sa√∫de desta ave √©, portanto, uma monitoriza√ß√£o indireta da carga de metais pesados e agroqu√≠micos no substrato produtivo do ecossistema.</p>
                </div>
            </div>
        `
            },
            {
                id: "habitat",
                title: "Habitat, Distribui√ß√£o e Migra√ß√£o",
                icon: "üåç",
                content: `
            <div class="space-y-3">
                <p class="text-gray-700">Ave costeira altamente dependente de <strong>Zonas H√∫midas</strong> de baixa profundidade, preferindo √°guas salobras ou salgadas. A simbiose entre o Alfaiate e as salinas tradicionais √© o pilar da sua sobreviv√™ncia em territ√≥rio nacional. Estas estruturas humanas funcionam como <strong>habitats de substitui√ß√£o de alta qualidade</strong> face √† degrada√ß√£o das zonas h√∫midas naturais.</p>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mt-2">
                    <div class="bg-purple-50 p-3 rounded">
                        <h4 class="font-bold text-purple-700 border-b border-purple-200 pb-1">Popula√ß√£o Nidificante (Residente)</h4>
                        <p class="text-sm mt-2"><strong>√âpoca:</strong> Todo o ano (Nidifica√ß√£o em Maio/Junho)</p>
                        <p class="text-sm"><strong>Abund√¢ncia:</strong> Reduzida - 200 a 500 casais / 702 a 908 indiv√≠duos maturos (estimativa 2001/2002)</p>
                        <p class="text-sm mt-2">A popula√ß√£o nidificante √© pequena e concentra-se principalmente no <strong>Sotavento Algarvio</strong> (Faro, Olh√£o, Tavira e Castro Marim). As √°reas da Ria Formosa e Castro Marim s√£o de <strong>relev√¢ncia continental</strong>, albergando cerca de <strong>2% da popula√ß√£o reprodutora da Europa Ocidental</strong>.</p>
                        <p class="text-sm mt-1">N√∫cleos secund√°rios: Estu√°rios do Tejo e Sado (nidifica√ß√£o espor√°dica em expans√£o), Ria de Aveiro (n√∫cleo reprodutor recente, evidenciando tentativa de coloniza√ß√£o a Norte).</p>
                    </div>
                    <div class="bg-blue-50 p-3 rounded">
                        <h4 class="font-bold text-blue-700 border-b border-blue-200 pb-1">Popula√ß√£o Invernante (Migradora)</h4>
                        <p class="text-sm mt-2"><strong>√âpoca:</strong> Outubro a Mar√ßo (Pico: Novembro a Fevereiro)</p>
                        <p class="text-sm"><strong>Abund√¢ncia:</strong> Milhares - 7.000 a 20.000 indiv√≠duos</p>
                        <p class="text-sm mt-2">Portugal √© <strong>vital para a invernada</strong>. Entre Outubro e Mar√ßo, recebemos milhares de aves vindas do norte da Europa (Reino Unido, Holanda). O <strong>Estu√°rio do Tejo</strong> acolhe a maior concentra√ß√£o.</p>
                        <p class="text-sm mt-1"><strong>Perspetiva Hist√≥rica:</strong> H√° cerca de 40 anos, o Estu√°rio do Tejo albergava cerca de <strong>75% a 80% da popula√ß√£o invernante da Europa Ocidental</strong>. Hoje, embora os n√∫meros se tenham dispersado por Fran√ßa e It√°lia, o Tejo continua vital, acolhendo cerca de <strong>15% a 20%</strong> do total da rota do Atl√¢ntico Este, conferindo a este estu√°rio uma responsabilidade internacional √∫nica.</p>
                    </div>
                </div>

                <p class="font-bold text-purple-800 border-b border-purple-200 pb-1 mt-4">Requisitos de Micro-habitat</p>
                <ul class="list-disc pl-5 space-y-2 text-gray-700">
                    <li><strong>Nidifica√ß√£o:</strong> Prefer√™ncia por <strong>c√¥moros</strong> (as eleva√ß√µes de terra que separam os tanques) de salinas tradicionais. Exige locais abertos, com pouca ou nenhuma vegeta√ß√£o, onde realiza posturas em maio e junho. A depend√™ncia das salinas tradicionais cria uma vulnerabilidade econ√≥mica: se a atividade salineira cessa, o habitat degrada-se.</li>
                    <li><strong>Invernada e Repouso:</strong> Depende de <strong>lodos intertidais</strong> ricos em invertebrados e zonas de √°guas pouco profundas para descanso (diurno e noturno), sendo particularmente ativo ao amanhecer e ao crep√∫sculo.</li>
                    <li><strong>Profundidade:</strong> √Åguas de baixa profundidade - a ave caminha em √°guas mais profundas que outras lim√≠colas devido √†s suas patas longas.</li>
                </ul>

                <p class="text-xs text-gray-500 mt-2"><strong>Nota:</strong> A esp√©cie realiza movimentos dispersivos ap√≥s a reprodu√ß√£o (p√≥s-nupciais) em busca de locais ricos em alimento para a muda da pena.</p>
            </div>
        `
            },
            {
                id: "reproducao",
                title: "Ciclo de Vida e Reprodu√ß√£o",
                icon: "üê£",
                content: `
            <div class="space-y-3">
                <p class="text-gray-700">O Alfaiate √© uma ave colonial com uma estrat√©gia de sobreviv√™ncia fascinante baseada em crias nid√≠fugas - poucas horas ap√≥s a eclos√£o, os pequenos pintos abandonam o ninho para seguir os pais.</p>

                <ul class="list-disc pl-5 space-y-2 text-gray-700">
                    <li><strong>Comportamento Colonial:</strong> Nidifica em col√≥nias, frequentemente mistas com outras lim√≠colas (como o Pernilongo). Esta estrat√©gia aumenta a efic√°cia na defesa contra predadores atrav√©s da vigil√¢ncia coletiva.</li>
                    
                    <li><strong>Escolha do Local de Nidifica√ß√£o:</strong> Prefer√™ncia por c√¥moros (divis√≥rias de terra) das salinas tradicionais com vegeta√ß√£o escassa. Localiza-se preferencialmente em ilh√©us ou estruturas elevadas para evitar inunda√ß√µes e predadores terrestres.</li>
                    
                    <li><strong>Estrutura do Ninho:</strong> Simples depress√£o no solo, diretamente numa pequena cavidade, por vezes forrada com detritos vegetais ou conchas. Ninhos no solo extremamente vulner√°veis.</li>
                    
                    <li><strong>Per√≠odo de Postura:</strong> Uma √∫nica postura por ano, geralmente em <strong>Maio/Junho</strong>. P√µe 3 a 4 ovos de cor creme com pintas escuras (camuflagem perfeita).</li>
                    
                    <li><strong>Incuba√ß√£o:</strong> Partilhada por ambos os progenitores durante <strong>23 a 25 dias</strong> (aproximadamente 3 semanas). Ambos os progenitores s√£o dedicados ao longo de todo o processo.</li>
                    
                    <li><strong>Crias Nid√≠fugas:</strong> As crias nascem cobertas de penugem e com plumagem sarapintada que se camufla perfeitamente entre as pedras. Abandonam o ninho <strong>horas ap√≥s a eclos√£o</strong>. S√£o capazes de se alimentar sozinhas, embora acompanhem os pais at√© ganharem capacidade de voo completa (35 a 42 dias).</li>
                    
                    <li><strong>Cuidado Parental Prolongado:</strong> Ambos os progenitores protegem as crias mesmo ap√≥s estas atingirem a independ√™ncia, demonstrando forte investimento parental.</li>
                </ul>

                <div class="bg-red-50 p-3 rounded mt-3 border-l-4 border-red-400">
                    <p class="text-sm font-bold text-red-800">Vulnerabilidades Cr√≠ticas</p>
                    <p class="text-xs text-red-700 mt-1">Estes ninhos no solo est√£o expostos a perigos severos:</p>
                    <ul class="text-xs text-red-700 list-disc pl-5 mt-1">
                        <li>Circula√ß√£o de ve√≠culos nos c√¥moros das salinas</li>
                        <li>Preda√ß√£o por gaivotas, corvos, c√£es, raposas</li>
                        <li>Perturba√ß√£o humana durante per√≠odo cr√≠tico de nidifica√ß√£o</li>
                        <li>Submers√£o por gest√£o inadequada de n√≠veis de √°gua</li>
                    </ul>
                    <p class="text-xs text-red-700 mt-1">O sucesso reprodutor est√° <strong>diretamente ligado √† manuten√ß√£o f√≠sica dos c√¥moros</strong> e √† gest√£o rigorosa dos n√≠veis de √°gua.</p>
                </div>
            </div>
        `
            },
            {
                id: "conservacao",
                title: "Conserva√ß√£o e Estatuto",
                icon: "üõ°Ô∏è",
                content: `
            <div class="space-y-3">
                <p class="font-bold text-gray-800 mb-2">Estatuto de Conserva√ß√£o - An√°lise Diferenciada</p>
                
                <div class="bg-gray-50 p-3 rounded">
                    <table class="w-full text-sm">
                        <thead>
                            <tr class="border-b-2 border-gray-300">
                                <th class="text-left py-2">Escala de Avalia√ß√£o</th>
                                <th class="text-left py-2">Popula√ß√£o Nidificante</th>
                                <th class="text-left py-2">Popula√ß√£o Invernante</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="border-b border-gray-200">
                                <td class="py-2 font-semibold">Global (UICN)</td>
                                <td class="text-green-600 font-bold">LC - Pouco Preocupante</td>
                                <td class="text-green-600 font-bold">LC - Pouco Preocupante</td>
                            </tr>
                            <tr class="border-b border-gray-200">
                                <td class="py-2 font-semibold">Europeu (BirdLife)</td>
                                <td>N√£o SPEC (N√£o Amea√ßada)</td>
                                <td>Est√°vel / Em aumento</td>
                            </tr>
                            <tr class="border-b border-gray-200">
                                <td class="py-2 font-semibold">Nacional (Livro Vermelho PT)</td>
                                <td class="text-yellow-600 font-bold">NT (D1)* - Quase Amea√ßado</td>
                                <td class="text-green-600 font-bold">LC - Pouco Preocupante</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="bg-blue-50 p-3 rounded mt-3 border-l-4 border-blue-400">
                    <p class="text-sm font-bold text-blue-800">Justifica√ß√£o do Estatuto Nacional (NT)</p>
                    <p class="text-xs text-blue-700 mt-1">A categoria <strong>NT (D1)*</strong> para a popula√ß√£o nidificante baseia-se num efetivo reduzido, inferior a 1.000 indiv√≠duos maturos (estimados entre 702 e 908 indiv√≠duos em 2001/2002). Houve um ajustamento regional: a esp√©cie desceu uma categoria de amea√ßa (de Vulner√°vel para Quase Amea√ßado) devido √† forte probabilidade de <strong>imigra√ß√£o de popula√ß√µes vizinhas</strong>, nomeadamente de Espanha, onde a esp√©cie est√° em expans√£o.</p>
                </div>
                
                <h4 class="font-bold mt-4 text-red-700">Principais Amea√ßas e Riscos Antropog√©nicos</h4>
                <ul class="list-disc pl-5 space-y-2 text-gray-700 text-sm">
                    <li><strong>1. Perda e Degrada√ß√£o de Habitat:</strong> O <strong>abandono da salicultura tradicional</strong> leva √† secagem dos tanques ou √† sua convers√£o para aquacultura industrial/intensiva, que n√£o oferece condi√ß√µes de nidifica√ß√£o adequadas. A transi√ß√£o ou abandono total resultam na perda de c√¥moros de nidifica√ß√£o e altera√ß√£o das profundidades de alimenta√ß√£o. Se a atividade salineira cessa, o habitat degrada-se rapidamente.</li>
                    
                    <li><strong>2. Polui√ß√£o Qu√≠mica e Bioacumula√ß√£o:</strong> 
                        <ul class="list-circle pl-5 mt-1">
                            <li><strong>Metais Pesados:</strong> O merc√∫rio √© uma preocupa√ß√£o espec√≠fica e documentada no Estu√°rio do Tejo. A contamina√ß√£o dos lodos estuarinos (tamb√©m Chumbo) afeta toda a cadeia alimentar.</li>
                            <li><strong>Agroqu√≠micos:</strong> Uso proveniente das bacias agr√≠colas envolventes amea√ßa a viabilidade das presas e o sucesso reprodutivo atrav√©s da contamina√ß√£o do sedimento superficial.</li>
                            <li><strong>Indicador Precoce:</strong> Como o Alfaiate varre a camada superficial, √© a primeira esp√©cie a ingerir contaminantes, tornando-se um bioindicador cr√≠tico.</li>
                        </ul>
                    </li>
                    
                    <li><strong>3. Infraestruturas e Colis√µes:</strong> Linhas el√©tricas e parques e√≥licos representam amea√ßas letais, especialmente em dias de baixa visibilidade. A literatura cita explicitamente a constru√ß√£o de grandes pontes (ex: Ponte Vasco da Gama) como amea√ßa, embora os dados locais sobre o impacto real care√ßam de monitoriza√ß√£o publicada para confirma√ß√£o t√©cnica.</li>
                    
                    <li><strong>4. Perturba√ß√£o Humana:</strong> Turismo desordenado, mariscadores e c√£es vadios nas zonas de nidifica√ß√£o causam <strong>abandono dos ninhos</strong>. A press√£o urban√≠stica provoca fragmenta√ß√£o do habitat e perturba√ß√£o direta, impedindo o descanso e a alimenta√ß√£o eficaz.</li>
                    
                    <li><strong>5. Preda√ß√£o Natural Amplificada:</strong> Gaivotas, corvos e raposas atacam ovos e crias. Em √°reas sem gest√£o adequada, as taxas de preda√ß√£o podem destruir col√≥nias inteiras.</li>
                    
                    <li><strong>6. Ca√ßa Ilegal:</strong> Embora protegida, a ca√ßa ilegal √© citada como amea√ßa em contextos internacionais.</li>
                </ul>

                <div class="mt-4 p-3 bg-yellow-50 border-l-4 border-yellow-500 rounded">
                    <p class="text-sm font-bold text-yellow-800">S√≠mbolo da Conserva√ß√£o</p>
                    <p class="text-xs text-yellow-700">O Alfaiate foi escolhido como <strong>s√≠mbolo da Reserva Natural do Estu√°rio do Tejo (RNET)</strong>, representando a import√¢ncia internacional desta zona h√∫mida e a necessidade urgente de prote√ß√£o dos ecossistemas estuarinos.</p>
                </div>
            </div>
        `
            },
            {
                id: "protecao-legal",
                title: "Enquadramento Legal e Gest√£o",
                icon: "‚öñÔ∏è",
                content: `
            <div class="space-y-3">
                <p class="font-bold text-purple-800 border-b border-purple-200 pb-1">Prote√ß√£o Jur√≠dica</p>
                <p class="text-gray-700 text-sm">O Alfaiate goza de uma <strong>prote√ß√£o jur√≠dica robusta</strong>, que deve ser o alicerce de qualquer parecer t√©cnico ou planeamento territorial:</p>
                
                <ul class="list-disc pl-5 space-y-2 text-gray-700 text-sm">
                    <li><strong>Decreto-Lei 140/99 (Transposi√ß√£o da Diretiva Aves - Anexo I):</strong> Obriga √† prote√ß√£o rigorosa e conserva√ß√£o de habitats. Esp√©cie de interesse comunit√°rio que requer medidas especiais de conserva√ß√£o.</li>
                    <li><strong>Conven√ß√£o de Berna (Anexo II):</strong> Prote√ß√£o internacional de esp√©cies estritamente protegidas.</li>
                    <li><strong>Conven√ß√£o de Bona (Anexo II):</strong> Prote√ß√£o de esp√©cies migradoras que necessitam de acordos internacionais de conserva√ß√£o.</li>
                    <li><strong>Rede Natura 2000:</strong> Os habitats cr√≠ticos do Alfaiate (Ria Formosa, Castro Marim, Estu√°rio do Tejo, Sado) est√£o inclu√≠dos na rede europeia de √°reas protegidas.</li>
                </ul>

                <div class="bg-red-50 p-3 rounded mt-3 border-l-4 border-red-400">
                    <p class="text-sm font-bold text-red-800">D√©fice Estrat√©gico de Dados</p>
                    <p class="text-xs text-red-700 mt-1">Apesar da import√¢ncia do pa√≠s, existe um <strong>hiato de 15 a 20 anos</strong> na publica√ß√£o de dados atualizados sobre os censos de invernada em Portugal. Esta falta de transpar√™ncia e de acessibilidade √† informa√ß√£o constitui uma <strong>barreira estrat√©gica</strong> para o planeamento nacional e para a elabora√ß√£o de Estudos de Impacte Ambiental (EIA) rigorosos. √â imperativo que as autoridades competentes e a comunidade cient√≠fica estabele√ßam plataformas de dados abertos para permitir uma gest√£o baseada na evid√™ncia.</p>
                </div>

                <p class="font-bold text-purple-800 border-b border-purple-200 pb-1 mt-4">Diretrizes de Gest√£o e Conserva√ß√£o</p>
                <p class="text-gray-700 text-sm">Para assegurar a resili√™ncia das popula√ß√µes e a conformidade com a Rede Natura 2000, a gest√£o deve ser <strong>ativa e baseada em dados</strong>:</p>

                <ul class="list-disc pl-5 space-y-2 text-gray-700 text-sm mt-2">
                    <li><strong>1. Sustentabilidade Econ√≥mica das Salinas:</strong> Incentivar a manuten√ß√£o das salinas atrav√©s da certifica√ß√£o de "Sal Verde" ou artesanal, ligando a conserva√ß√£o do Alfaiate ao <strong>valor de mercado do produto</strong>. As salinas devem ser geridas como um patrim√≥nio biol√≥gico de elevado valor.</li>
                    
                    <li><strong>2. Gest√£o Hidrol√≥gica e Infraestruturas:</strong>
                        <ul class="list-circle pl-5 mt-1">
                            <li>Cria√ß√£o de <strong>ilhas de nidifica√ß√£o artificiais</strong> para minimizar a preda√ß√£o</li>
                            <li><strong>Sinaliza√ß√£o anti-colis√£o obrigat√≥ria</strong> em linhas el√©tricas pr√≥ximas de √°reas de repouso</li>
                            <li>Gest√£o rigorosa dos n√≠veis de √°gua para evitar submers√£o dos ninhos</li>
                        </ul>
                    </li>
                    
                    <li><strong>3. Controlo de Preda√ß√£o:</strong> Implementar programas de controlo de gaivotas e mam√≠feros oportunistas (c√£es e raposas) que predam ninhos no solo em √°reas protegidas como Castro Marim e Ria Formosa.</li>
                    
                    <li><strong>4. Fiscaliza√ß√£o de Polui√ß√£o:</strong> Fiscalizar rigorosamente o funcionamento das ETARs (Esta√ß√µes de Tratamento de √Åguas Residuais) e o uso de agroqu√≠micos nas bacias adjacentes para garantir que a √°gua que alimenta as salinas n√£o √© um vetor de contamina√ß√£o.</li>
                    
                    <li><strong>5. Minimiza√ß√£o de Perturba√ß√£o:</strong> Regulamenta√ß√£o e fiscaliza√ß√£o do acesso humano durante o per√≠odo de nidifica√ß√£o (Maio/Junho). Educa√ß√£o de turistas e utilizadores das zonas costeiras.</li>
                    
                    <li><strong>6. Monitoriza√ß√£o Sistem√°tica:</strong> Estabelecer programas de monitoriza√ß√£o de longo prazo com censos regulares e publica√ß√£o transparente de dados. Monitorizar contaminantes nos sedimentos e nas pr√≥prias aves.</li>
                </ul>

                <div class="bg-green-50 p-3 rounded mt-3 border-l-4 border-green-400">
                    <p class="text-sm font-bold text-green-800">Responsabilidade Internacional</p>
                    <p class="text-xs text-green-700 mt-1">A responsabilidade de Portugal na conserva√ß√£o do Alfaiate √© de <strong>escala europeia</strong>. Portugal mant√©m o seu papel central como porto de abrigo nas rotas migrat√≥rias pale√°rticas. A conformidade legal e a monitoriza√ß√£o cient√≠fica s√£o as √∫nicas garantias contra o decl√≠nio desta esp√©cie ic√≥nica e resiliente.</p>
                </div>
            </div>
        `
            },
            {
                id: "curiosidades",
                title: "Curiosidades e Comportamento",
                icon: "üí°",
                content: `
            <div class="space-y-3 text-gray-700">
                <p><strong>1. Estrat√©gia da "Asa Partida" (Broken Wing Display):</strong></p>
                <p class="text-sm ml-4 border-l-2 border-purple-200 pl-2 bg-purple-50 p-2 rounded">Quando um predador se aproxima do ninho, os adultos simulam estar feridos, arrastando uma asa no ch√£o e emitindo vocaliza√ß√µes de alarme para atrair a aten√ß√£o do predador e afast√°-lo dos ovos ou crias. Esta √© uma t√©cnica de distra√ß√£o sofisticada. Quando o predador est√° longe o suficiente do ninho, a ave levanta voo repentinamente, revelando que estava apenas a fingir. √â um exemplo extraordin√°rio de comportamento parental protetor.</p>
                
                <p class="mt-3"><strong>2. Agressividade Defensiva:</strong></p>
                <p class="text-sm ml-4 border-l-2 border-purple-200 pl-2 bg-purple-50 p-2 rounded">Apesar da apar√™ncia elegante e da plumagem delicada, os Alfaiates s√£o <strong>extremamente agressivos</strong> na defesa da col√≥nia. Bombardeiam em voo (dive-bombing) intrusos muito maiores, incluindo gar√ßas, tartaranh√µes e at√© pessoas que se aproximam demasiado. Atacam em grupo, criando um sistema de defesa coletivo eficaz. A vocaliza√ß√£o durante estes ataques √© alta e persistente.</p>
                
                <p class="mt-3"><strong>3. Capacidade de Nata√ß√£o √önica:</strong></p>
                <p class="text-sm ml-4 border-l-2 border-purple-200 pl-2 bg-purple-50 p-2 rounded">Ao contr√°rio de muitas lim√≠colas que apenas caminham em √°guas rasas, o Alfaiate <strong>nada muito bem</strong> gra√ßas √†s membranas interdigitais (patas palmadas) - uma caracter√≠stica rara entre as lim√≠colas. Em voo ou a nadar, pode parecer um pequeno pato branco devido √† sua silhueta e cor. Esta adapta√ß√£o permite-lhe explorar habitats aqu√°ticos mais profundos e escapar de predadores terrestres.</p>

                <p class="mt-3"><strong>4. Comportamento Social e Colonial:</strong></p>
                <p class="text-sm ml-4 border-l-2 border-purple-200 pl-2 bg-purple-50 p-2 rounded">A nidifica√ß√£o em col√≥nias mistas com outras lim√≠colas (especialmente o Pernilongo) cria uma rede de vigil√¢ncia coletiva. M√∫ltiplos pares de olhos aumentam a dete√ß√£o precoce de predadores. As vocaliza√ß√µes de alarme s√£o partilhadas entre esp√©cies, beneficiando toda a col√≥nia.</p>

                <p class="mt-3"><strong>5. Adapta√ß√£o √†s Salinas:</strong></p>
                <p class="text-sm ml-4 border-l-2 border-purple-200 pl-2 bg-purple-50 p-2 rounded">O Alfaiate √© um exemplo perfeito de uma esp√©cie que se adaptou a habitats criados pelo Homem. As salinas tradicionais, embora sejam estruturas artificiais, replicam t√£o eficazmente as condi√ß√µes das zonas h√∫midas naturais que se tornaram <strong>habitat preferencial</strong> da esp√©cie. Esta simbiose demonstra que a atividade humana, quando sustent√°vel, pode coexistir com a conserva√ß√£o da biodiversidade.</p>

                <p class="mt-3"><strong>6. Longevidade e Fidelidade:</strong></p>
                <p class="text-sm ml-4 border-l-2 border-purple-200 pl-2 bg-purple-50 p-2 rounded">Com registos de indiv√≠duos que viveram at√© <strong>28 anos</strong>, o Alfaiate demonstra extraordin√°ria longevidade para uma ave lim√≠cola. Muitos indiv√≠duos demonstram fidelidade ao local de nidifica√ß√£o, regressando ano ap√≥s ano ao mesmo c√¥moro de salina.</p>

                <div class="bg-blue-50 p-3 rounded mt-4 border-l-4 border-blue-400">
                    <p class="text-sm font-bold text-blue-800">Para Observadores</p>
                    <p class="text-xs text-blue-700 mt-1"><strong>Melhor √©poca de observa√ß√£o:</strong> Inverno (Novembro a Fevereiro) para grandes bandos, especialmente no Estu√°rio do Tejo e Sado. Para observar comportamento reprodutor, Maio/Junho no Algarve (Ria Formosa, Castro Marim).</p>
                    <p class="text-xs text-blue-700 mt-1"><strong>Dica de campo:</strong> Procure o movimento caracter√≠stico de "costura" lateral da cabe√ßa em √°guas rasas. O contraste branco e preto torna a ave facilmente identific√°vel mesmo √† dist√¢ncia.</p>
                </div>
            </div>
        `
            },
            {
                id: "checklist",
                title: "Checklist de Campo para Observa√ß√£o",
                icon: "‚úÖ",
                content: `
            <div class="space-y-3">
                <p class="text-gray-700 mb-3">Preparem os bin√≥culos e verifiquem estes pontos na vossa pr√≥xima sa√≠da de observa√ß√£o:</p>

                <div class="bg-gray-50 p-4 rounded border border-gray-200">
                    <h4 class="font-bold text-purple-700 mb-3">Caracter√≠sticas de Identifica√ß√£o</h4>
                    <ul class="space-y-2">
                        <li class="flex items-start">
                            <span class="text-purple-600 mr-2">‚òê</span>
                            <span class="text-sm"><strong>Bico curvo para cima?</strong> (A ferramenta t√°til flex√≠vel essencial - distintamente recurvado)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-purple-600 mr-2">‚òê</span>
                            <span class="text-sm"><strong>Movimento lateral de varredura?</strong> (O gesto caracter√≠stico de "costura" no lodo)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-purple-600 mr-2">‚òê</span>
                            <span class="text-sm"><strong>Plumagem branca com manchas pretas n√≠tidas?</strong> (Contraste impec√°vel)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-purple-600 mr-2">‚òê</span>
                            <span class="text-sm"><strong>Efeito de "brilho" ou cintila√ß√£o do bando em voo?</strong> (Mudan√ßa visual em un√≠ssono)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-purple-600 mr-2">‚òê</span>
                            <span class="text-sm"><strong>Patas longas cinzento-azuladas?</strong> (Palmadas - raro em lim√≠colas)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-purple-600 mr-2">‚òê</span>
                            <span class="text-sm"><strong>Comprimento aproximado 42-46 cm?</strong> (Porte m√©dio-grande)</span>
                        </li>
                    </ul>
                </div>

                <div class="bg-blue-50 p-4 rounded border border-blue-200 mt-3">
                    <h4 class="font-bold text-blue-700 mb-3">Comportamento e Habitat</h4>
                    <ul class="space-y-2">
                        <li class="flex items-start">
                            <span class="text-blue-600 mr-2">‚òê</span>
                            <span class="text-sm"><strong>Vocaliza√ß√£o ou comportamento de alerta perto de c√¥moros?</strong> (Especialmente durante per√≠odo de nidifica√ß√£o)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-600 mr-2">‚òê</span>
                            <span class="text-sm"><strong>Habitat de salina ou zona intertidal lamacenta?</strong> (Habitat caracter√≠stico)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-600 mr-2">‚òê</span>
                            <span class="text-sm"><strong>Comportamento de nata√ß√£o?</strong> (Capacidade √∫nica entre lim√≠colas)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-600 mr-2">‚òê</span>
                            <span class="text-sm"><strong>Nidifica√ß√£o colonial?</strong> (Frequentemente com outras lim√≠colas como Pernilongo)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-blue-600 mr-2">‚òê</span>
                            <span class="text-sm"><strong>Alimenta√ß√£o ativa ao amanhecer/crep√∫sculo?</strong> (Per√≠odos de maior atividade)</span>
                        </li>
                    </ul>
                </div>

                <div class="bg-green-50 p-4 rounded border border-green-200 mt-3">
                    <h4 class="font-bold text-green-700 mb-3">Localiza√ß√£o e √âpoca</h4>
                    <ul class="space-y-2">
                        <li class="flex items-start">
                            <span class="text-green-600 mr-2">‚òê</span>
                            <span class="text-sm"><strong>Estu√°rio do Tejo ou Sado (Out-Mar)?</strong> (Principais locais de invernada)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-600 mr-2">‚òê</span>
                            <span class="text-sm"><strong>Sotavento Algarvio - Ria Formosa/Castro Marim (Mai-Jun)?</strong> (Nidifica√ß√£o)</span>
                        </li>
                        <li class="flex items-start">
                            <span class="text-green-600 mr-2">‚òê</span>
                            <span class="text-sm"><strong>Ria de Aveiro?</strong> (N√∫cleo reprodutor recente)</span>
                        </li>
                    </ul>
                </div>

                <div class="bg-yellow-50 p-3 rounded mt-4 border-l-4 border-yellow-500">
                    <p class="text-sm font-bold text-yellow-800">‚ö†Ô∏è C√≥digo de √âtica do Observador</p>
                    <ul class="text-xs text-yellow-700 mt-2 space-y-1">
                        <li>‚Ä¢ Mantenha dist√¢ncia segura, especialmente durante a nidifica√ß√£o (Maio/Junho)</li>
                        <li>‚Ä¢ Nunca entre em c√¥moros de salinas ou √°reas de nidifica√ß√£o</li>
                        <li>‚Ä¢ Evite perturba√ß√µes sonoras ou movimentos bruscos</li>
                        <li>‚Ä¢ Reporte avistamentos a organiza√ß√µes de conserva√ß√£o</li>
                        <li>‚Ä¢ Respeite a sinaliza√ß√£o de √°reas protegidas</li>
                        <li>‚Ä¢ Observem com respeito e protejam o que √© nosso</li>
                    </ul>
                </div>

                <p class="text-sm text-gray-600 italic mt-3 text-center">Boas observa√ß√µes! üê¶</p>
            </div>
        `
            }
        ];

        const flashcardData = [
            { q: "Nome cient√≠fico do Alfaiate?", a: "Recurvirostra avosetta" },
            { q: "Fam√≠lia taxon√≥mica?", a: "Recurvirostridae" },
            { q: "Comprimento m√°ximo?", a: "46 cm" },
            { q: "Longevidade m√°xima?", a: "28 anos" },
            { q: "Forma do bico?", a: "Longo e recurvado para cima" },
            { q: "Movimento de alimenta√ß√£o?", a: "Varredura (varrimento lateral)" },
            { q: "Dieta principal?", a: "Insetos, crust√°ceos, vermes" },
            { q: "Sentido usado na ca√ßa?", a: "Tato (bico sens√≠vel)" },
            { q: "Estatuto Nidificante (PT)?", a: "Quase Amea√ßado (NT)" },
            { q: "Estatuto Invernante (PT)?", a: "Pouco Preocupante (LC)" },
            { q: "S√≠mbolo de qual √°rea?", a: "R. N. Estu√°rio do Tejo" },
            { q: "Regi√£o principal de nidifica√ß√£o?", a: "Algarve (Sotavento)" },
            { q: "Locais de invernada?", a: "Estu√°rios do Tejo e Sado" },
            { q: "Meses de observa√ß√£o (pico)?", a: "Outubro a Mar√ßo" },
            { q: "Habitat de nidifica√ß√£o?", a: "Salinas (c√¥moros)" },
            { q: "Crias s√£o...?", a: "Nid√≠fugas (precoces)" },
            { q: "N¬∫ de ovos por postura?", a: "3 ou 4" },
            { q: "Tempo de incuba√ß√£o?", a: "23 a 25 dias" },
            { q: "Socializa√ß√£o?", a: "Esp√©cie colonial" },
            { q: "Amea√ßa de habitat?", a: "Abandono de salinas" },
            { q: "Poluente no Tejo?", a: "Merc√∫rio" },
            { q: "Tipo de bico (rigidez)?", a: "Flex√≠vel (como borracha)" },
            { q: "Atividade alimentar (hor√°rio)?", a: "Dia e Noite" },
            { q: "Varrivelas por minuto?", a: "Aprox. 28" },
            { q: "Substrato preferido?", a: "Sedimentos brandos (lodos)" },
            { q: "V√≠nculo do casal?", a: "Monog√¢mico sazonal" },
            { q: "Defesa de ninho?", a: "Simula√ß√£o de asa partida" },
            { q: "Significado de Nid√≠fugo?", a: "Abandona ninho ap√≥s nascer" },
            { q: "Regi√£o Biogeogr√°fica?", a: "Pale√°rctico" },
            { q: "Patas especiais?", a: "Palmadas (membranas)" }
        ];

        const glossaryData = [
            { term: "C√¥moros", def: "Diques de terra que separam tanques nas salinas; local de nidifica√ß√£o." },
            { term: "Estu√°rio", def: "Zona onde o rio encontra o mar, rica em nutrientes e sedimentos." },
            { term: "Invernante", def: "Popula√ß√£o que usa uma regi√£o para passar o inverno." },
            { term: "Lim√≠cola", def: "Ave que vive em zonas de lodo ou areia (zonas h√∫midas)." },
            { term: "Nid√≠fugo", def: "Crias que abandonam o ninho logo ap√≥s a eclos√£o." },
            { term: "Pale√°rctico", def: "Regi√£o biogeogr√°fica que inclui Europa, N. √Åfrica e √Åsia." },
            { term: "Poliquetas", def: "Vermes marinhos que servem de alimento." },
            { term: "Salinas", def: "Habitat artificial de produ√ß√£o de sal, vital para o Alfaiate." },
            { term: "Varrivelas", def: "Movimentos laterais r√°pidos do bico para capturar alimento." },
            { term: "ZPE", def: "Zona de Prote√ß√£o Especial (Diretiva Aves)." },
            { term: "Dimorfismo", def: "Diferen√ßa visual entre macho e f√™mea da mesma esp√©cie." },
            { term: "Col√≥nia", def: "Grupo de aves que nidificam pr√≥ximas umas das outras." }
        ];

        const quizData = [
            {
                q: "Qual √© a principal caracter√≠stica do bico do Alfaiate?",
                options: ["Curto e grosso", "Longo e recurvado para cima", "Direito e vermelho", "Largo como uma colher"],
                correct: 1,
                feedback: "Correto! O bico √© recurvado para cima, adaptado para varrer o lodo."
            },
            {
                q: "O Alfaiate √© o s√≠mbolo de que √Årea Protegida?",
                options: ["Ria Formosa", "Estu√°rio do Sado", "Estu√°rio do Tejo", "Peneda-Ger√™s"],
                correct: 2,
                feedback: "Exato! √â o s√≠mbolo da Reserva Natural do Estu√°rio do Tejo desde a sua cria√ß√£o."
            },
            {
                q: "As crias de Alfaiate s√£o nid√≠fugas. O que significa?",
                options: ["Nascem cegas", "Ficam no ninho 2 meses", "Abandonam o ninho logo ap√≥s nascer", "S√£o alimentadas bico-a-bico"],
                correct: 2,
                feedback: "Certo! Elas nascem desenvolvidas e procuram o seu pr√≥prio alimento imediatamente."
            },
            {
                q: "Qual √© a t√©cnica de alimenta√ß√£o utilizada?",
                options: ["Mergulho profundo", "Picagem vertical", "Varredura lateral", "Captura em voo"],
                correct: 2,
                feedback: "Isso mesmo! Faz um movimento de 'ceifar' ou 'coser' lateralmente."
            },
            {
                q: "(V/F) O Alfaiate alimenta-se apenas durante o dia.",
                options: ["Verdadeiro", "Falso"],
                correct: 1,
                feedback: "Falso! Gra√ßas ao tato sens√≠vel do bico, pode alimentar-se eficazmente √† noite."
            },
            {
                q: "Onde √© que o Alfaiate prefere fazer o ninho?",
                options: ["Em √°rvores", "Em rochas", "Nos c√¥moros das salinas", "Flutuando na √°gua"],
                correct: 2,
                feedback: "Correto! Usa os diques de terra (c√¥moros) entre os tanques das salinas."
            },
            {
                q: "Qual o estatuto de conserva√ß√£o da popula√ß√£o nidificante em Portugal?",
                options: ["Pouco Preocupante", "Quase Amea√ßado", "Em Perigo", "Extinto"],
                correct: 1,
                feedback: "Sim, √© Quase Amea√ßado (NT) devido ao n√∫mero reduzido de casais reprodutores."
            },
            {
                q: "Qual destas √© uma amea√ßa √† esp√©cie?",
                options: ["Constru√ß√£o de ninhos", "Abandono de salinas", "Excesso de peixe", "Migra√ß√£o"],
                correct: 1,
                feedback: "Correto. O abandono das salinas tradicionais destr√≥i o seu habitat preferencial."
            },
            {
                q: "O que come principalmente o Alfaiate?",
                options: ["Peixes grandes", "Algas", "Invertebrados (insetos/vermes)", "Sementes"],
                correct: 2,
                feedback: "Certo! √â uma ave carn√≠vora especializada em pequenos invertebrados."
            },
            {
                q: "(V/F) O bico do Alfaiate √© r√≠gido como osso.",
                options: ["Verdadeiro", "Falso"],
                correct: 1,
                feedback: "Falso! √â flex√≠vel e sens√≠vel, comparado frequentemente a borracha."
            },
            {
                q: "Que comportamento usa o Alfaiate para afastar predadores do ninho?",
                options: ["Canta melodiosamente", "Simula ter uma asa partida", "Esconde-se na areia", "Cospe veneno"],
                correct: 1,
                feedback: "Correto! Finge estar ferido para atrair a aten√ß√£o do predador para longe das crias."
            },
            {
                q: "Em que √©poca do ano ocorrem as maiores concentra√ß√µes em Portugal?",
                options: ["Ver√£o (Junho-Agosto)", "Inverno (Outubro-Mar√ßo)", "Apenas em Janeiro", "Todo o ano igual"],
                correct: 1,
                feedback: "Certo! Portugal recebe milhares de aves invernantes do norte da Europa."
            },
            {
                q: "Qual destas adapta√ß√µes √© rara em lim√≠colas mas presente no Alfaiate?",
                options: ["Bico longo", "P√©s palmados", "Penas brancas", "Voar"],
                correct: 1,
                feedback: "Muito bem! Os p√©s palmados permitem-lhe nadar, algo incomum em aves de lodo."
            },
            {
                q: "Qual √© o principal crust√°ceo das salinas que serve de alimento?",
                options: ["Lagosta", "Caranguejo-violinista", "Artemia", "Camar√£o-tigre"],
                correct: 2,
                feedback: "Correto! A Artemia salina √© uma fonte de alimento fundamental nestes habitats."
            },
            {
                q: "(V/F) Os Alfaiates s√£o aves solit√°rias que evitam outras esp√©cies.",
                options: ["Verdadeiro", "Falso"],
                correct: 1,
                feedback: "Falso! S√£o coloniais e muitas vezes nidificam junto de pernilongos e andorinhas-do-mar."
            },
            // NOVAS QUEST√ïES ADICIONADAS
            {
                q: "Qual √© o nome cient√≠fico do Alfaiate?",
                options: ["Charadrius hiaticula", "Recurvirostra avosetta", "Himantopus himantopus", "Limosa limosa"],
                correct: 1,
                feedback: "Correto! Recurvirostra avosetta √© a nomenclatura oficial para a esp√©cie."
            },
            {
                q: "Qual √© a longevidade m√°xima aproximada registada para o Alfaiate?",
                options: ["15 anos", "20 anos", "28 anos", "35 anos"],
                correct: 2,
                feedback: "Exato! √â uma ave que pode viver quase tr√™s d√©cadas, at√© 28 anos."
            },
            {
                q: "Qual √© a tend√™ncia atual da popula√ß√£o europeia de Alfaiates?",
                options: ["Em decl√≠nio acentuado", "Est√°vel ou em aumento", "Extinta na natureza", "Desconhecida"],
                correct: 1,
                feedback: "Correto! A n√≠vel europeu, a esp√©cie √© considerada est√°vel ou em aumento."
            },
            {
                q: "Onde nidifica o Alfaiate de forma habitual em Portugal?",
                options: ["Estu√°rio do Minho", "Ria de Aveiro", "Sotavento Algarvio (Faro a Castro Marim)", "Lagoa de Santo Andr√©"],
                correct: 2,
                feedback: "Certo! O Algarve concentra a quase totalidade da popula√ß√£o reprodutora residente."
            },
            {
                q: "Qual √© o intervalo t√≠pico de indiv√≠duos na popula√ß√£o invernante em Portugal?",
                options: ["500 a 1.000", "5.000 a 7.000", "10.000 a 15.000", "Mais de 50.000"],
                correct: 2,
                feedback: "Correto! Portugal recebe entre 10.000 a 15.000 indiv√≠duos invernantes."
            },
            {
                q: "Quantas 'varrivelas' pode um Alfaiate realizar por minuto durante a alimenta√ß√£o?",
                options: ["5 a 10", "28 a 46", "Exatamente 100", "Mais de 200"],
                correct: 1,
                feedback: "Exato! Pode realizar entre 28 a 46 movimentos de bico por minuto."
            },
            {
                q: "Qual metal pesado √© mencionado como contaminante no Estu√°rio do Tejo?",
                options: ["Chumbo", "C√°dmio", "Merc√∫rio", "Zinco"],
                correct: 2,
                feedback: "Correto! O merc√∫rio √© um metal pesado acumulativo identificado como amea√ßa."
            },
            {
                q: "A que fam√≠lia pertence o Alfaiate?",
                options: ["Ardeidae", "Recurvirostridae", "Scolopacidae", "Charadriidae"],
                correct: 1,
                feedback: "Certo! A fam√≠lia Recurvirostridae agrupa aves com estas morfologias de bico."
            },
            {
                q: "Quais s√£o os meses principais para ver o Alfaiate no Estu√°rio do Sado?",
                options: ["Junho a Agosto", "Novembro a Fevereiro", "Mar√ßo a Maio", "Apenas em Setembro"],
                correct: 1,
                feedback: "Correto! Novembro a Fevereiro √© o per√≠odo de maior abund√¢ncia durante a invernada."
            },
            {
                q: "Qual √© a dimens√£o t√≠pica de uma postura do Alfaiate?",
                options: ["1 ovo", "3 a 4 ovos", "8 a 10 ovos", "12 a 15 ovos"],
                correct: 1,
                feedback: "Certo! A postura padr√£o √© de 3 a 4 ovos."
            },
            {
                q: "A esp√©cie √© considerada colonial na reprodu√ß√£o?",
                options: ["N√£o, √© estritamente solit√°ria", "Sim, √© geralmente colonial", "Sim, mas apenas em ilhas oce√¢nicas", "N√£o, as col√≥nias s√≥ se formam no inverno"],
                correct: 1,
                feedback: "Correto! √â geralmente colonial, embora possa ser ocasionalmente solit√°ria."
            },
            {
                q: "Que percentagem da popula√ß√£o invernante europeia se concentra em apenas 10 locais?",
                options: ["25%", "50%", "75%", "90%"],
                correct: 3,
                feedback: "Exato! 90% concentra-se em poucos locais, o que aumenta a vulnerabilidade da esp√©cie."
            },
            {
                q: "Qual √© o comprimento m√°ximo aproximado do corpo de um Alfaiate?",
                options: ["20 cm", "32 cm", "46 cm", "60 cm"],
                correct: 2,
                feedback: "Correto! √â uma ave de porte m√©dio entre as lim√≠colas, com at√© 46 cm."
            },
            {
                q: "Qual era a percentagem hist√≥rica de alfaiates europeus que invernavam no Estu√°rio do Tejo?",
                options: ["15%", "40%", "75% a 80%", "100%"],
                correct: 2,
                feedback: "Certo! Dados hist√≥ricos mostram que 75% a 80% invernavam no Tejo."
            },
            {
                q: "Qual √© a representatividade atual do Estu√°rio do Tejo para a popula√ß√£o invernante?",
                options: ["5%", "15%", "50%", "95%"],
                correct: 1,
                feedback: "Correto! Atualmente cerca de 15%, tendo diminu√≠do devido √† dispers√£o por outros pa√≠ses."
            },
            {
                q: "(V/F) A popula√ß√£o nidificante em Portugal √© inferior a 1.000 indiv√≠duos maturos.",
                options: ["Verdadeiro", "Falso"],
                correct: 0,
                feedback: "Verdadeiro! Dados de 2001/2002 registaram entre 702 e 908 indiv√≠duos maturos."
            },
            {
                q: "(V/F) As salinas s√£o habitats vitais para a alimenta√ß√£o e nidifica√ß√£o desta esp√©cie.",
                options: ["Verdadeiro", "Falso"],
                correct: 0,
                feedback: "Verdadeiro! O abandono das salinas tradicionais √© uma das maiores amea√ßas √† esp√©cie."
            },
            {
                q: "(V/F) A constru√ß√£o da Ponte Vasco da Gama √© citada como o principal fator de amea√ßa.",
                options: ["Verdadeiro", "Falso"],
                correct: 1,
                feedback: "Falso! O foco principal est√° na perda de habitat e degrada√ß√£o de salinas."
            }
        ];

        // --- STATE MANAGEMENT --- //

        let state = {
            currentTab: 'study',
            flashcardIndex: 0,
            quizScore: 0,
            currentQuestion: 0,
            highScore: parseInt(localStorage.getItem('alfaiate_highscore')) || 0
        };

        // --- INITIALIZATION --- //

        document.addEventListener('DOMContentLoaded', () => {
            renderStudyContent();
            renderGlossaryList();
            renderFlashcard();
            loadProgress();

            // Check medals
            updateMedals(state.highScore);
            document.getElementById('high-score').textContent = state.highScore;
        });

        // --- NAVIGATION --- //

        function switchTab(tabId) {
            // Update State
            state.currentTab = tabId;
            saveProgress();

            // Hide all sections
            document.querySelectorAll('.tab-content').forEach(el => {
                el.classList.add('hidden');
            });

            // Show target section
            document.getElementById(tabId).classList.remove('hidden');

            // Update Desktop Nav
            document.querySelectorAll('.nav-btn').forEach(btn => {
                if (btn.dataset.tab === tabId) {
                    btn.classList.add('bg-purple-800', 'text-white', 'shadow-inner');
                    btn.classList.remove('text-purple-100');
                } else {
                    btn.classList.remove('bg-purple-800', 'text-white', 'shadow-inner');
                    btn.classList.add('text-purple-100');
                }
            });

            // Update Progress Bar visuals
            const progressMap = { 'study': '25%', 'flashcards': '50%', 'glossary': '75%', 'quiz': '100%' };
            document.getElementById('progress-bar').style.width = progressMap[tabId];

            // Close mobile menu if open
            document.getElementById('mobile-menu').classList.add('hidden');

            window.scrollTo(0, 0);
        }

        function toggleMobileMenu() {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        }

        function openModal(id) { document.getElementById(id).classList.remove('hidden'); }
        function closeModal(id) { document.getElementById(id).classList.add('hidden'); }

        // --- PERSISTENCE --- //
        function saveProgress() {
            localStorage.setItem('alfaiate_tab', state.currentTab);
        }

        function loadProgress() {
            const savedTab = localStorage.getItem('alfaiate_tab');
            if (savedTab) switchTab(savedTab);
            else switchTab('study');
        }

        // --- RENDERERS --- //

        // 1. Study Guide
        function renderStudyContent() {
            const container = document.getElementById('study-content');
            container.innerHTML = studyData.map(item => `
                <div class="bg-white rounded-lg shadow border-l-4 border-purple-400 overflow-hidden">
                    <button class="w-full text-left px-6 py-4 flex justify-between items-center focus:outline-none bg-gray-50 hover:bg-gray-100 transition" onclick="toggleAccordion('${item.id}')">
                        <span class="font-bold text-lg text-purple-900 flex items-center gap-3">
                            <span class="text-2xl">${item.icon}</span> ${item.title}
                        </span>
                        <svg id="icon-${item.id}" class="w-5 h-5 text-purple-500 transform transition-transform" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
                    </button>
                    <div id="content-${item.id}" class="hidden px-6 py-4 border-t border-gray-100 text-gray-700 leading-relaxed">
                        ${item.content}
                    </div>
                </div>
            `).join('');
        }

        function toggleAccordion(id) {
            const content = document.getElementById(`content-${id}`);
            const icon = document.getElementById(`icon-${id}`);
            content.classList.toggle('hidden');
            icon.classList.toggle('rotate-180');
        }

        // 2. Flashcards
        function setFlashcardMode(mode) {
            const viewMode = document.getElementById('fc-view-mode');
            const gameMode = document.getElementById('fc-game-mode');

            if (mode === 'view') {
                viewMode.classList.remove('hidden');
                gameMode.classList.add('hidden');
            } else {
                viewMode.classList.add('hidden');
                gameMode.classList.remove('hidden');
                initMatchGame('flashcards');
            }
        }

        function renderFlashcard() {
            const card = flashcardData[state.flashcardIndex];
            document.getElementById('fc-front').textContent = card.q;
            document.getElementById('fc-back').textContent = card.a;
            document.getElementById('fc-counter').textContent = `${state.flashcardIndex + 1} / ${flashcardData.length}`;

            // Ensure card starts facing front
            const el = document.getElementById('current-flashcard');
            if (el.classList.contains('rotate-y-180')) el.classList.remove('rotate-y-180');
        }

        function flipCard(el) {
            el.firstElementChild.classList.toggle('rotate-y-180');
        }

        function nextCard() {
            if (state.flashcardIndex < flashcardData.length - 1) {
                state.flashcardIndex++;
                renderFlashcard();
            }
        }

        function prevCard() {
            if (state.flashcardIndex > 0) {
                state.flashcardIndex--;
                renderFlashcard();
            }
        }

        // 3. Glossary
        function setGlossaryMode(mode) {
            const listMode = document.getElementById('glossary-list-mode');
            const gameMode = document.getElementById('glossary-game-mode');

            if (mode === 'list') {
                listMode.classList.remove('hidden');
                gameMode.classList.add('hidden');
            } else {
                listMode.classList.add('hidden');
                gameMode.classList.remove('hidden');
                initMatchGame('glossary');
            }
        }

        function renderGlossaryList() {
            const container = document.getElementById('glossary-list-mode');
            container.innerHTML = glossaryData.map(item => `
                <div class="bg-white p-4 rounded-lg shadow-sm border border-purple-100 hover:shadow-md transition">
                    <h4 class="font-bold text-purple-700 text-lg mb-1">${item.term}</h4>
                    <p class="text-gray-600 text-sm">${item.def}</p>
                </div>
            `).join('');
        }

        // --- GAME LOGIC (MATCHING) --- //

        let selectedGameItem = null;
        let gamePairs = [];
        let gameMatchedCount = 0;

        function initMatchGame(type) {
            const container = type === 'flashcards' ? document.getElementById('fc-game-container') : document.getElementById('glossary-game-container');
            const messageEl = type === 'flashcards' ? document.getElementById('fc-game-message') : document.getElementById('glossary-game-message');

            container.innerHTML = '';
            messageEl.textContent = '';
            messageEl.className = 'text-center mt-6 text-xl font-bold text-purple-700 min-h-[2rem]';
            selectedGameItem = null;
            gameMatchedCount = 0;

            // Select 6 random items
            const source = type === 'flashcards' ? flashcardData : glossaryData;
            const items = [...source].sort(() => 0.5 - Math.random()).slice(0, 6);
            gamePairs = items.length;

            // Create arrays for Questions (Left) and Answers (Right) or just mixed for glossary
            let inputs = [];

            items.forEach((item, index) => {
                const qKey = type === 'flashcards' ? item.q : item.term;
                const aKey = type === 'flashcards' ? item.a : item.def;

                inputs.push({ id: `q-${index}`, text: qKey, type: 'q', matchId: index });
                inputs.push({ id: `a-${index}`, text: aKey, type: 'a', matchId: index });
            });

            // Shuffle display
            inputs.sort(() => 0.5 - Math.random());

            inputs.forEach(item => {
                const btn = document.createElement('button');
                btn.className = `p-4 bg-white border-2 border-purple-200 rounded shadow hover:bg-purple-50 transition text-sm text-center flex items-center justify-center min-h-[80px] w-full select-none`;
                btn.textContent = item.text;
                btn.dataset.id = item.id;
                btn.dataset.matchId = item.matchId;
                btn.dataset.type = item.type;

                btn.onclick = () => handleGameClick(btn, type, items.length);
                container.appendChild(btn);
            });

            // For flashcards, enforce grid structure slightly better if possible, but random mix is harder/fun
            if (type === 'flashcards') {
                container.className = "grid grid-cols-2 md:grid-cols-4 gap-4 max-w-5xl mx-auto";
            }
        }

        function handleGameClick(el, type, totalPairs) {
            if (el.classList.contains('bg-green-100')) return; // Already matched
            const messageEl = type === 'flashcards' ? document.getElementById('fc-game-message') : document.getElementById('glossary-game-message');

            // Select
            if (!selectedGameItem) {
                selectedGameItem = el;
                el.classList.add('border-purple-600', 'bg-purple-100');
                return;
            }

            // Deselect if same clicked
            if (selectedGameItem === el) {
                selectedGameItem = null;
                el.classList.remove('border-purple-600', 'bg-purple-100');
                return;
            }

            // Check Match
            if (selectedGameItem.dataset.matchId === el.dataset.matchId) {
                // Match!
                selectedGameItem.classList.remove('border-purple-600', 'bg-purple-100');
                selectedGameItem.classList.add('bg-green-100', 'border-green-500', 'opacity-50', 'cursor-default');
                el.classList.add('bg-green-100', 'border-green-500', 'opacity-50', 'cursor-default');

                selectedGameItem = null;
                gameMatchedCount++;
                messageEl.textContent = "Correto! üéâ";
                messageEl.className = "text-center mt-6 text-xl font-bold text-green-600 animate-pulse";

                if (gameMatchedCount === totalPairs) {
                    messageEl.textContent = "Parab√©ns! Completaste o desafio! üèÜ";
                }
            } else {
                // Fail
                el.classList.add('bg-red-100', 'border-red-500');
                selectedGameItem.classList.add('bg-red-100', 'border-red-500');
                messageEl.textContent = "Tenta outra vez...";
                messageEl.className = "text-center mt-6 text-xl font-bold text-red-600";

                const temp1 = selectedGameItem;
                const temp2 = el;
                selectedGameItem = null;

                setTimeout(() => {
                    temp1.classList.remove('bg-red-100', 'border-red-500', 'bg-purple-100', 'border-purple-600');
                    temp2.classList.remove('bg-red-100', 'border-red-500');
                    messageEl.textContent = "";
                }, 1000);
            }
        }

        // --- QUIZ LOGIC --- //

        function startQuiz() {
            state.quizScore = 0;
            state.currentQuestion = 0;
            document.getElementById('quiz-start').classList.add('hidden');
            document.getElementById('quiz-container').classList.remove('hidden');
            document.getElementById('quiz-results').classList.add('hidden');
            loadQuestion();
        }

        function loadQuestion() {
            const q = quizData[state.currentQuestion];
            document.getElementById('q-current').textContent = state.currentQuestion + 1;
            document.getElementById('q-total').textContent = quizData.length;
            document.getElementById('current-score').textContent = state.quizScore;

            document.getElementById('question-text').textContent = q.q;

            const optsContainer = document.getElementById('options-container');
            optsContainer.innerHTML = '';

            q.options.forEach((opt, idx) => {
                const btn = document.createElement('button');
                btn.className = "w-full text-left p-4 rounded border border-gray-200 hover:bg-purple-50 hover:border-purple-300 transition flex items-center gap-3";
                btn.innerHTML = `<span class="bg-gray-200 text-gray-700 w-6 h-6 rounded-full flex items-center justify-center text-xs font-bold">${String.fromCharCode(65 + idx)}</span> ${opt}`;
                btn.onclick = () => handleAnswer(idx, btn);
                optsContainer.appendChild(btn);
            });

            document.getElementById('feedback-area').classList.add('hidden');
        }

        function handleAnswer(selectedIndex, btnElement) {
            const q = quizData[state.currentQuestion];
            const feedbackArea = document.getElementById('feedback-area');
            const feedbackText = document.getElementById('feedback-text');
            const feedbackTitle = document.getElementById('feedback-title');

            // Disable all buttons
            const buttons = document.getElementById('options-container').querySelectorAll('button');
            buttons.forEach(b => b.disabled = true);

            if (selectedIndex === q.correct) {
                state.quizScore += 10;
                document.getElementById('current-score').textContent = state.quizScore;
                btnElement.classList.add('bg-green-100', 'border-green-500');
                feedbackArea.className = "mt-6 p-4 rounded-lg bg-green-50 border border-green-200 fade-in";
                feedbackTitle.textContent = "Correto! ‚úÖ";
                feedbackTitle.className = "font-bold mb-1 text-green-800";
                feedbackText.className = "text-sm text-green-800";
            } else {
                btnElement.classList.add('bg-red-100', 'border-red-500');
                // Highlight correct one
                buttons[q.correct].classList.add('bg-green-50', 'border-green-300');
                feedbackArea.className = "mt-6 p-4 rounded-lg bg-red-50 border border-red-200 fade-in";
                feedbackTitle.textContent = "Incorreto ‚ùå";
                feedbackTitle.className = "font-bold mb-1 text-red-800";
                feedbackText.className = "text-sm text-red-800";
            }

            feedbackText.textContent = q.feedback;
            feedbackArea.classList.remove('hidden');
        }

        function nextQuestion() {
            state.currentQuestion++;
            if (state.currentQuestion < quizData.length) {
                loadQuestion();
            } else {
                finishQuiz();
            }
        }

        function finishQuiz() {
            document.getElementById('quiz-container').classList.add('hidden');
            document.getElementById('quiz-results').classList.remove('hidden');

            const finalScore = state.quizScore;
            document.getElementById('final-score').textContent = finalScore;

            // Update High Score
            if (finalScore > state.highScore) {
                state.highScore = finalScore;
                localStorage.setItem('alfaiate_highscore', state.highScore);
                updateMedals(finalScore);
            }

            // Message
            const msgEl = document.getElementById('result-message');
            const maxScore = quizData.length * 10;
            const percentage = (finalScore / maxScore) * 100;

            if (percentage === 100) msgEl.textContent = "Perfeito! √âs um verdadeiro especialista no Alfaiate!";
            else if (percentage >= 70) msgEl.textContent = "Excelente trabalho! Conheces muito bem esta esp√©cie.";
            else if (percentage >= 50) msgEl.textContent = "Bom esfor√ßo! Continua a estudar os flashcards.";
            else msgEl.textContent = "N√£o desanimes. Rev√™ o Guia de Estudo e tenta novamente!";
        }

        function resetQuiz() {
            document.getElementById('quiz-results').classList.add('hidden');
            document.getElementById('quiz-start').classList.remove('hidden');
        }

        function updateMedals(score) {
            const bronze = document.getElementById('medal-bronze');
            const silver = document.getElementById('medal-silver');
            const gold = document.getElementById('medal-gold');

            // Adjusted logic for 33 questions (max 330 points)
            // Bronze > 111 (33%), Silver > 222 (66%), Gold > 300 (90%)
            if (score >= 111) bronze.classList.remove('opacity-30');
            if (score >= 222) silver.classList.remove('opacity-30');
            if (score >= 300) gold.classList.remove('opacity-30');
        }

        function generateCertificate() {
            const name = document.getElementById('student-name').value;
            if (!name) {
                alert("Por favor, introduz o teu nome.");
                return;
            }

            document.getElementById('cert-name').textContent = name;

            const now = new Date();
            document.getElementById('cert-date').textContent = now.toLocaleDateString('pt-PT');

            window.print();
        }

    </script>
</body>

</html>